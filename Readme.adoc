= Simple Digital Security Scheme
:source-highlighter: highlightjs
:docdate: 2023-01-04
:author: Alexander Nemish <anemish@gmail.com>
:toc: left

== Abstract
Keeping your data safe is hard.
Keeping your data safe and easy to use among multitude devices and services is even harder.
Here is a KISS security setup scheme for your MacBook, iPhone,
and web services that is easy to use and relatively hard to break.

It's based on the idea of using a combination of a random 3-4 word passphrase
and a 6 digits PIN, along with a password manager and TouchID/FaceID devices.

The scheme allows to regain access to all of your data
even in case of losing all of your devices, or in case of your death,
leaving your digital legacy to your loved ones.

== Desired properties

=== Easy to use

[quote,AviD's Rule of Usability, Nuff sad]
Security at the expense of usability comes at the expense of security.

=== Lowest amount of memorised information

Humans are notoriously bad at memorising long strings of random characters.
We are good at memorising short phrases, and making up stories about them.

This classic comics is a good illustration of the problem

image::https://imgs.xkcd.com/comics/password_strength.png[xkcd 936]

=== No single point of failure

Duh. Any device loss must not compromise your security nor lead to sensitive data loss.

=== Cross-platform

The scheme must work on any platform, including mobile, desktop, and web.

=== Bootstrapping

Even if every hardware item you own is lost you still can regain access to everything.
Imaging an act of God of your dislike. You're fleeing from rashists in Ukraine or in Siria.
There is a fire in your house. You get the point.

=== Legacy

* Third-parties of your choice are able to access all your info after your death
* Any third-party can be safely revoked from access to anything
* Compromised Third-party is safe

=== Really secure info

If you have some really secure info that you want to keep extra safe, you can do it.
For example, you have some important PGP keys, crypto wallets, or some passwords for your bank accounts.

* Really secure info can't be accessed even when the laptop/phone is fully compromised
* Really secure info can't be accessed even when your primary email/Bitwarden is compromised
* Really secure info can't be accessed even when your 3rd parties are compromised
* Plausible deniability. You have an option to store really secure info in a separate vault that is not accessible by your 3rd parties.
They can't even know that you have such a vault.

=== Minimum software/hardware

Only well-known, well-tested, well-supported open-source software.


== Assumptions and Prerequisites
* AES256, SHA256 are secure
* FaceID and TouchID are secure
* iPhones ≥ 7 are secure
* MacBook FileVault2 is secure
* Bitwarden is secure
* VeraCrypt is secure
* You have several 3-rd parties who can identify you and will cooperate
* Your significant other is not a malevolent psychopath
* You are not a subject of state-level attack
* You use iPhone ≥ 7 with TouchID/FaceID
* You use a MacBook with T2 security chip
* You have a Google and/or iCloud accounts
* Your MacBook and iPhone are not hacked at the time of setup

== Scheme Overview
=== TL;DR
. Generate a random 6 digits PIN and memorise it. That's your phone PIN, and your SIM PIN.

. Generate 3 random words using https://www.eff.org/dice[EFF Dice] or https://diceware.dmuth.org/[Diceware].
Combine with the PIN and memorise the passphrase.
That's your https://bitwarden.com/[Bitwarden] Master Password.

. Take a word and combine it with PIN. That's you laptop password. You MAY store it in Bitwarden.

. Use Bitwarden to generate strong passwords and TOTP 2FA codes for all your services.

. Store your sensitive info in Bitwarden.

. Store your really sensitive info in a Google Drive/iCloud synced VeraCrypt volume.

.Don't use these values in real life.
====
* PIN 984073
* Words: `cake` `roping` `vocation`
* Bitwarden Master password: `cake984073ropingvocation`
* Laptop password: `984vocation073`
====

One good in-memory only password protects all your other passwords, TOTP 2FA, Recovery codes, etc.

All your passwords are generated by Bitwarden, that ensures they are strong, secure, encrypted with a strong encryption algorithm, and synced securely between your devices.

And you don't need to enter your PIN, laptop password and Bitwarden password very often thanks to TouchID/FaceID.

=== Passwords Security Analysis

6 digits PIN is ~20 bits of entropy, 3 Diceware words give another ~39 bits of entropy. Combined with ~3 bits of PIN permutations, the scheme gives roughly 62 bits of entropy for the Bitwarden Master Password.

Bitwarden https://bitwarden.com/help/what-encryption-is-used/#pbkdf2[uses 100,000] iterations of PBKDF2 with HMAC-SHA256
to derive the encryption key from the Master Password.
Assuming an attacker can compute PBKDF2-SHA256 with 1 GiOps/s (see <<pbkdf2>>),
62 bits of entropy is enough to resist brute-force attacks for about 7 million years.

.JavaScript code to calculate the entropy and the number years to brute-force the password
[code,javascript]
....
const dicewareDictionary = 7776; // 6^5
const dicewareWords = 3;
const dicewareBits = Math.log2(dicewareDictionary ** dicewareWords);
const pinLength = 6;
const pinBits = Math.log2(10 ** pinLength);
// split PIN in parts, put them in different places, 10 permutations
const permutationBits = Math.log2(10);
const entropyBits = Math.floor(dicewareBits + pinBits + permutationBits);
const pbkdf2Sha256PerSecond = 1e9; // 1 GH/s
// Bitwarden uses 100,000 iterations of PBKDF2 with HMAC-SHA256
const iterations = 100000;
const pwdPerSecond = pbkdf2Sha256PerSecond / iterations;
const numTries = 2 ** (entropyBits - 1);
const seconds = numTries / pwdPerSecond;
const secondsInYear = 365 * 24 * 60 * 60;
const years = seconds / secondsInYear;
console.log('Password Entroy: ' + entropyBits + ' bits ')
console.log('Estimated time to brute-force: ' + years + ' years')
// outputs:
// Password Entroy: 62 bits
// Estimated time to brute-force: 7311780.216938401 years
....


iPhones, and MacBooks with T2 chip mitigate password brute-force attacks by requiring a longer delay between password attempts on the hardware level.
iPhone can be configured to wipe all the data after 10 unsuccessful attempts.

Even with the https://appleinsider.com/articles/22/02/17/password-cracking-tool-can-slowly-brute-force-t2-mac-passwords[recently discovered flaw], MacBooks' passwords can be tried at 15 passwords per second, makeing it essentially impossible to brute-force.

=== Why Bitwarden?

Bitwarden is open-source, cross-platform, cross-browser, free, and has a good reputation. The code is audited and the company is trustworthy.

It supports storing TOTP 2FA, TouchID/FaceID unlocking, allows Emergency Access, and it's easy to use. It is well integrated with iOS and MacOS.

https://1password.com/[1Password] is a good alternative, but it's not open-source, and it's not free.
Regardless, this scheme can be easily used with 1Password. You don't need to switch to Bitwarden if you already use 1Password.

https://keepassxc.org/[KeyPassXC] doesn't work on iPhones.

https://blog.lastpass.com/2022/12/notice-of-recent-security-incident/[Avoid LastPass].

=== Legacy and bootstrapping

If you want to leave your digital legacy to your loved ones,
you can do it with Bitwarden https://bitwarden.com/help/emergency-access/[Emergency Access].

If you have some Really Secure Info and you store it in a separate vault,
you can leave the vault password to your loved ones.

Basically, you store your Secure Vault password in an encrypted file
that you share with your loved ones.

The encryption password is derived from your Master Password.
You store it in your Google Digital Legacy Plan along with instructions on how to access your Secury Vault.

In case of your death, your loved ones will receive a notification from Google
and will be able to access your encrypted file with your Secury Vault password.

If you loose all your devices, you can ask your loved ones
to give you the encrypted file with your Secure Vault password,
derive the password from your Master Password, and access your Secury Vault.

If you stop trusting one of your loved ones
you can revoke their access to your encrypted file by changing a version of the derived password,
re-encrypting the file, and sharing it with your loved ones again.

Don't forget to update your Google Digital Legacy Plan accordingly.

=== Pros
- remember only 3 words and 6 digits, easy
- super easy to use, rarely need to enter your PIN, laptop password or Bitwarden password
- loss of any device is neither security nor data loss concern
- can bootstrap from nothing just knowing your Master password
- Bitwarden password is good enough for brute-force attacks in case the vault is breached (like in LastPass situation)
- laptop password is good enough to resist brute-force attacks in case the laptop is stolen
- you can share your PIN and even your laptop password with your significant other and they still can't easily access Master password protected items in Bitwarden. They can if they know what they are doing, though.
- in case you distrust your significant other – just change your PIN on your phone, laptop, and Bitwarden.

=== Cons

- you are screwed if someone shoulder-hunts or records your Bitwarden password,
unless you setup 2FA in Bitwarden.
Watch your back when you need to enter the password.
- you are screwed if an attacker has access to your phone or laptop and knows their passwords
- you are screwed in case of your spouse is malevolent and knows the scheme
- you are screwed if the laptop is rooted or even keylogged
- you don't want to store crypto wallet seeds in Bitwarden with this setup,
unless you are accepting the risk of losing your crypto

== Setup Guide
=== Bitwarden Master Password and iPhone PIN
. Generate a random 6 digits PIN and memorise it.
+
That's your phone PIN, and your SIM PIN.

. Setup you SIM to require PIN, otherwise an attacker can steal your phone and use it for 2FA via SMS. (_Settings -> Mobile Data -> Carrier -> SIM PIN_)

. Setup your iPhone to erase all the data after 10 failed PIN attempts.
+
(_Settings -> Face ID & Passcode -> Erase Data_).
See full iPhone setup instructions xref:_iphone_setup[below].

. Generate 3 random words using https://www.eff.org/dice[EFF Dice] or https://diceware.dmuth.org/[Diceware].
Combine with the PIN and memorise the passphrase.
+
That's your Bitwarden Master Password.

. Take a word and combine it with PIN. That's you laptop password. You MAY store it in Bitwarden.
+
ifdef::backend-html5[]
.Randomly Generated credentials
====
++++
<p>Random PIN: <code id="pin"></code><p>
<p>Random words: <code id="words"></code><p>
<p>Master Password: <code id="MasterPassword"></code><p>
<p>Laptop Password: <code id="LaptopPassword"></code><p>
<p><button id="GenerateButton">Generate</button><p>
<script src="wordlist.js">
</script>
<script>
let pinStr = '';
let MasterPassword = '';
function generate() {
  const array = new Uint32Array(5);
  self.crypto.getRandomValues(array);
  const pin = array[0] % 1000000;
  pinStr = pin.toString().padStart(6, "0");
  document.getElementById("pin").innerText = pinStr;
  const words = [
    wordlist[array[1] % (6**5)],
    wordlist[array[2] % (6**5)],
    wordlist[array[3] % (6**5)]
  ];
  const permutation = array[4] % 10;
  const parts = [];
  const pinParts = [pinStr.slice(0, 3), pinStr.slice(3)];
  switch (permutation) {
  case 0: parts.push(pinParts[0]); parts.push(pinParts[1]); parts.push(words[0]); parts.push(words[1]); parts.push(words[2]); break;
  case 1: parts.push(pinParts[0]); parts.push(words[0]); parts.push(pinParts[1]);parts.push(words[1]); parts.push(words[2]); break;
  case 2: parts.push(pinParts[0]); parts.push(words[0]); parts.push(words[1]); parts.push(pinParts[1]); parts.push(words[2]); break;
  case 3: parts.push(pinParts[0]); parts.push(words[0]); parts.push(words[1]); parts.push(words[2]); parts.push(pinParts[1]); break;
  case 4: parts.push(words[0]); parts.push(pinParts[0]); parts.push(pinParts[1]); parts.push(words[1]); parts.push(words[2]); break;
  case 5: parts.push(words[0]); parts.push(pinParts[0]); parts.push(words[1]); parts.push(pinParts[1]); parts.push(words[2]); break;
  case 6: parts.push(words[0]); parts.push(pinParts[0]); parts.push(words[1]); parts.push(words[2]); parts.push(pinParts[1]); break;
  case 7: parts.push(words[0]); parts.push(words[1]); parts.push(pinParts[0]); parts.push(pinParts[1]); parts.push(words[2]); break;
  case 8: parts.push(words[0]); parts.push(words[1]); parts.push(pinParts[0]); parts.push(words[2]); parts.push(pinParts[1]); break;
  case 9: parts.push(words[0]); parts.push(words[1]); parts.push(words[2]); parts.push(pinParts[0]); parts.push(pinParts[1]); break;
  }
  MasterPassword = parts.join("");
  let LaptopPassword = words[0] + pinStr;
  document.getElementById("words").innerText = words.join(" ");
  document.getElementById("MasterPassword").innerText = MasterPassword;
  document.getElementById("LaptopPassword").innerText = LaptopPassword;
}
document.getElementById("GenerateButton").onclick = generate;
generate();
</script>
++++
====
endif::backend-html5[]
ifndef::backend-html5[]
.Don't use these values in real life.
====
* PIN 984073
* Words: `cake` `roping` `vocation`
* Bitwarden Master password: `cake984073ropingvocation`
* Laptop password: `984vocation073`
====
endif::backend-html5[]
+
. Setup your MacBook according to xref:_macbook_setup[these recommendations].

. Install Bitwarden app on all your devices and Bitwarden extensions for your web browsers. Enable TouchID/FaceID integration.
+
You MAY enable 2FA for your Bitwarden account. It's not necessary, but it's a good practice. Don't use TOTP, use email, YubiKey, FIDO2, and Recovery Code.

. Setup your iPhone for https://bitwarden.com/help/log-in-with-device/[Web Vault login] to avoid typing Bitwarden Master Password as much as possible.

. Store all passwords, TOTPs, Recovery codes etc in Bitwarden.

. Use Bitwarden Password Generator to generate secure passwords.

. Enable TOTP 2FA everywhere where there is such an option: Google, Facebook, Twitter, Instagram, banking, crypto exchanges, mobile providers etc.

. In case you use Google Authenticator, Duo, Authy or other, you may want to migrate to TOTP 2FA in Bitwarden to simplify things. It's OK.

=== iPhone Setup

* Setup iPhone passcode to be PIN: _Settings -> Face ID & Passcode_
* Delete all existing TouchID fingerprints or FaceID data and setup new ones: _Settings -> Face ID & Passcode -> Reset Face ID_
* Enable SIM PIN, set it to the first 4 digits of your iPhone PIN: _Settings -> Mobile Data -> Carrier -> SIM PIN_
+
This way we protect your phone from SIM hijacking and SIM swap attacks.
An attacker can't use your phone for 2FA via SMS if they don't have your PIN.

.Optionally:
* Enable wiping your data after 10 wrong attempts if you want to be extra secure:
_Settings -> Face ID & Passcode -> Erase Data_.
* Setup a security question/password with your mobile service provider to avoid SIM hijacking. Store it in Bitwarden.
* Disable all notifications on locked screen.
_Settings -> Notifications -> Show Previews -> When Unlocked_

=== MacBook Setup

* Enable FileVault2 encryption: _System Settings -> Privacy & Security -> FileVault_.
+
Store the hard drive Recovery code in Bitwarden.
* Enable TouchID
* Enable Firewall
* Setup https://apple.stackexchange.com/a/306324[PAM with TouchID] to avoid entering the laptop password on `sudo` commands.

=== Crypto Wallets

IMPORTANT: Use a hardware wallet for storing your crypto assets.

There is an interesting https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872[setup by Vincent Bounce]

=== Bootstrapping Setup
[#linux_usb_boot]
[NOTE]
====
Ideally this should be done on a USB booted Linux, like https://www.kali.org/[Kali Linux] or https://tails.boum.org/[Tails Linux].
But, at a time of writing, all of them have issues with MacBooks with T2 chips: the keyboard and trackpad don't work.
====

. Create a `Readme-$version.txt` file that contains the following information:
+
* Master Password
* PIN
* Google Account Backup Codes
* Bitwarden Backup Code
* iCloud Backup Code
* VeraCrypt Passwords
* Other passwords not stored in Bitwarden

. Derive a password for Readme.txt file from the Master Password.
+
.JavaScript code to compute the `DerivedMasterPwd`
[%collapsible]
====
[code,javascript]
....
const version = 0
const pwd = 'cake984073ropingvocation'
const salt = '984073'
const iterations = 100000 + version

const textEncoder = new TextEncoder("utf-8");
const passwordBuffer = textEncoder.encode(pwd);
const importedKey = await crypto.subtle.importKey("raw", passwordBuffer, "PBKDF2", false, ["deriveBits"]);

const saltBuffer = textEncoder.encode(salt);
const params = {name: "PBKDF2", hash: 'SHA-256', salt: saltBuffer, iterations: iterations};
const derivation = await crypto.subtle.deriveBits(params, importedKey, 32*8);
function buf2hex(buffer) { // buffer is an ArrayBuffer
  return [...new Uint8Array(buffer)] .map(x => x.toString(16).padStart(2, '0')) .join('');
}
console.log(buf2hex(derivation));
....
====
+
ifdef::backend-html5[]
++++
<p>Master Password: <input id="MasterPwdInput"/></p>
<p>PIN: <input id="Pin"/></p>
<p>Version: <input id="Version" value='0'/></p>
<button id="Compute">Compute</button>
<p>Derived Master Password: <span id="DerivedMasterPwd"></span></p>
<script>
function buf2hex(buffer) { // buffer is an ArrayBuffer
  return [...new Uint8Array(buffer)] .map(x => x.toString(16).padStart(2, '0')) .join('');
}
async function compute() {
  const version = document.getElementById('Version').value || 0
  const pwd = document.getElementById('MasterPwdInput').value
  const salt = document.getElementById('Pin').value
  const iterations = 100000 + version
  const textEncoder = new TextEncoder("utf-8");
  const passwordBuffer = textEncoder.encode(pwd);
  const importedKey = await crypto.subtle.importKey("raw", passwordBuffer, "PBKDF2", false, ["deriveBits"]);

  const saltBuffer = textEncoder.encode(salt);
  const params = {name: "PBKDF2", hash: 'SHA-256', salt: saltBuffer, iterations: iterations};
  const derivation = await crypto.subtle.deriveBits(params, importedKey, 32*8);

  document.getElementById('DerivedMasterPwd').innerText = buf2hex(derivation);
}
document.getElementById('MasterPwdInput').value = MasterPassword;
document.getElementById('Pin').value = pinStr;
document.getElementById('Compute').onclick = compute;
compute();
</script>
++++
endif::backend-html5[]
+
. Encrypt Readme-$version.txt with `DerivedMasterPwd` using AES256

  gpg -c --cipher-algo AES256 Readme-0.txt

. Transfer `Readme-0.txt.gpg` via Signal with auto-delete to trusted 3-rd parties. Ask to verify your identity upon requesting the file.

. Remove `Readme.txt` and `Readme-0.txt.gpg` from the laptop!

. Go to https://myaccount.google.com/data-and-privacy[Google Account -> Data & Privacy]

. Make a Plan for your Digital Legacy
+
Choose who to notify & what to share.

. Store the `DerivedMasterPwd` in your Google Digital Legacy Plan.
+
Example note:
+
[quote]
I guess I'm dead. Decrypt Readme-0.txt.gpg with `DerivedMasterPwd` to get my passwords. See-ya!
gpg -d --cipher-algo AES256 Readme-0.txt.gpg

== Usage

=== MacBook

You unlock your MacBook with your laptop password only after a reboot. Avoid doing it with someone watching or near a camera.
Unlock Bitwarden with TouchID, avoid typing your Master password. Login to Bitwarden Web Vault using your iPhone when needed.
Use TouchID for sudo, ssh, payments, FIDO2, etc.

=== iPhone

Same, use FaceID authentication everywhere possible.

[#secure-info-storage]
== Really Secure Info Storage and plausible deniability

You may want to store some really important info in a really secure way. For example, your crypto wallet seeds, PGP keys, Bitwarden Recovery Code etc.

You'll need https://veracrypt.fr/[VeraCrypt].

. Come up with a `SecurePIN` (6 digits), `VeraCryptNormalPassword`, and `VeraCryptHiddenPassword`.
+
Use a permutation of your Master Password, PIN, and SecurePIN.

. Create a VeraCrypt volume with a hidden volume, synced to Google Drive or iCloud Drive.

. Store seeds, PGP keys, SecurityInfoFile on Hidden Volume

. Store unimportant seeds, PGP keys, SecurityInfoFile on a normal volume

. In case you are forced to reveal the password to your VeraCrypt volume – you reveal your `VeraCryptNormalPassword` and deny the existence of the hidden volume.

NOTE: Ideally, you do this on a USB booted Linux, but see xref:linux_usb_boot[a note about that].

== Hardware Wallets and Seeds
For a hardware wallet either use your phone PIN, or better generate another 6 digits random `SecurePIN`, depending on your paranoia.

Store your seed either:

- in `Readme.txt` from the <<Bootstrapping Setup>>

Or even better, store the seed on a separate old offline iPhone with the `SecurePIN`.

Or store the seed in the hidden volume of your xref:secure-info-storage[Really Secure Info Storage].

Here is another interesting setup with 3 hardware wallets and an old iPhone:
https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872[You may store the seed on a separate old offline iPhone with the `SecurePIN`]

== Threats

=== A service password is hacked

Just change your password.
You are using 2FA, right?

=== Your iPhone or MacBook is stolen

Go to iCloud and erase your device.
Buy a new one and restore from backup.

Assuming your PIN/password is not known to the attacker, you are safe.
Your SIM card is safe, too.

=== Google banned you

You are fine.

=== Encrypted data is lost

=== SIM card is copied

You avoid SMS 2FA as much as possible so you are fine.

=== A third-party is no longer trusted

You update your Readme.txt and Readme-0.txt.gpg accordingly and share it with your trusted 3-rd parties.
You update your `DerivedMasterPwd` in your Google Digital Legacy Plan.
Now you are fine again.

=== Death

You have your Legacy plan in place.

=== The laptop is rooted

You are mostly screwed.
Your Really Secret Info is still safe if you only access it on a USB booted Linux or a specific air-gapped device.
Also, don't store Readme.txt.gpg on your laptop or in a cloud.

=== Targeted cyber attack, social engineering

That depends. You can be screwed if you are targeted.

=== Non violent intrusion

If you are forced to reveal your secrets by law, your Real Secret Info is fine.
See plausible deniability.

=== Kidnapping, violence, thermorectal cryptanalysis

You are screwed.

image::https://imgs.xkcd.com/comics/security.png[xkcd 538]

Use other means for storing your crypto.

https://keys.casa/


=== Spouse malevolence

If you spouse knows your PIN/laptop password then you are screwed.

If you suspect your spouse to become malevolent you can change your iPhone PIN and your laptop password, and reset all TouchID/FaceIDs. That should suffice.

== Scenarios

=== You have lost everything

. Ask a 3rd party for SecurityInfoFile
. Compute `DerivedMasterPwd`
. Login to Bitwarden with Bitwarden Backup Code
. Login to iCloud using iCloud Backup Code
. Login to GMail using Google Account Backup Codes
. Restore crypto wallets from seeds, PGP keys etc from your VeraCrypt volume on Google Drive

=== You have lost everything but iPhone

. Do the checklist of stolen laptop
. Restore wallets from seeds, transfer crypto
. Erase all stolen devices

=== Laptop is stolen, password is not known to a thief
An average thief can't access anything.

WARNING: If an advanced attacker can tamper the TouchID,
then he can do `sudo su -` with TouchID and gain admin privileges.
Then you are screwed.

=== Laptop is stolen with laptop password
* Attacker CAN access your Bitwarden, Gmail, TouchID/FIDO2, Github, Social Media, Messengers, iCloud, Google Account, etc.

* Attacker CAN access and unlink the laptop in iCloud by using TouchID and Safair browser to login to iCloud. I don't know how to prevent this.

* Attacker MAY steal your Google account in case you use iCloud email as a backup email and TouchID as 2FA. I don't know how to prevent this.

* Attacker CAN NOT access `SecureStorage` as he doesn't know the password

=== Laptop Lost Checklist
. Login to Bitwarden Web Vault
  [%interactive]
  * [ ] Go to Account Settings
  * [ ] Deauthorize your laptop session
  * [ ] Change Bitwarden password
. Login to iCloud
  [%interactive]
  * [ ] Settings -> Sing Out of All Browsers
  * [ ] Find Devices -> Laptop -> Erase Mac
. Login to Google
  [%interactive]
  * [ ] Manage Account -> Your devices -> Sing out
  * [ ] 2FA -> Remove TouchID key

=== iPhone is Stolen with PIN
* Attacker CAN access your Bitwarden, Gmail, TouchID/FIDO2, Github, Social Media, Messengers, iCloud, Google Account, etc.

* Attacker CAN access and unlink the laptop in iCloud by using TouchID and Safair browser to login to iCloud. I don't know how to prevent this.

* Attacker MAY steal your Google account in case you use iCloud email as a backup email and TouchID as 2FA. I don't know how to prevent this.

* Attacker CAN NOT access `SecureStorage` as he doesn't know the password

=== iPhone Lost Checklist

. Login to Bitwarden web vault
. Go to Account Settings
. Deauthorize session
. Change Bitwarden password
. Login to iCloud
. Settings -> Sing Out of All Browsers
. Find Devices -> iPhone -> Erase iPhone
. Login to Google
. Manage Account -> Your devices -> Sing out
. Banks as well

=== YubiKey is Lost or Stolen Checklist
. Setup new YubiKey from SecureStorage/OldPhone
. Change YubiKey Longtap password in SecureInfoFile
. Change VeraCrypt password
. Resend EncryptedSIF

=== Ledger is Stolen Checklist
. Setup new seed
. 5. 5. Transfer money
. Update SecureStorage

=== Death or Emergency
Spouse can access a laptop/phone, access Bitwarden/Gmail.
Leave a Emergency Note and tell to look it up in case of emergency.
Google Account Inactivity set up for 3 month with EmergencyInfo
EmergencyInfo = DerivedMasterPwd, Ledger/OldPhone SecurePIN

=== Spouse Distrust
. Change iPhone PIN
. Remove all iPhone FaceIDs and setup new one
. Change laptop password PIN to the new iPhonePIN
. Revoke Bitwarden Inactivity Access
. Revoke Google Inactivity Access
. Revoke iCloud Recovery Account

=== 3rd Party Distrust
. VersionNumber += 1
. Compute new `DerivedMasterPwd'`, `Readme-1.txt.gpg`
. Send `Readme-1.txt.gpg` to trusted 3rd-parties
. Remove distrusted 3rd-party from Google Legacy Plan
. Put new `DerivedMasterPwd'` in Google Legacy Plan notes

[glossary]
== Glossary

KISS:: Keep It Simple Stupid
TOTP:: Time-based One-time Password
2FA:: Two-factor Authentication
MFA:: Multi-factor Authentication

[bibliography]
== Bibliography, Useful Links, and Resources
* [[[crypto, crypto]]]
https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872
* [[[pbkdf2,pbkdf2]]] https://www.usenix.org/system/files/conference/woot16/woot16-paper-ruddick.pdf[Acceleration Attacks on PBKDF2]
* [[[T2]]] https://www.youtube.com/watch?v=0uh4vQa81AI[Physical Decrypted Images from Macs with the T2 Chip]
* [[[EFF]]] https://ssd.eff.org/module/creating-strong-passwords[Creating Strong Passwords]