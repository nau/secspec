<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="Alexander Nemish &lt;anemish@gmail.com&gt; @atlanter">
<title>Triple Sec â€“ Simple Digital Security Scheme</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Triple Sec â€“ Simple Digital Security Scheme</h1>
<div class="details">
<span id="author" class="author">Alexander Nemish &lt;anemish@gmail.com&gt; @atlanter</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_abstract">Abstract</a></li>
<li><a href="#_desired_properties">Desired properties</a>
<ul class="sectlevel2">
<li><a href="#_easy_to_use">Easy to use</a></li>
<li><a href="#_lowest_amount_of_memorized_information">Lowest amount of memorized information</a></li>
<li><a href="#_no_single_point_of_failure">No single point of failure</a></li>
<li><a href="#_cross_platform">Cross-platform</a></li>
<li><a href="#_bootstrapping">Bootstrapping</a></li>
<li><a href="#_legacy">Legacy</a></li>
<li><a href="#_really_important_info_security">Really important info security</a></li>
<li><a href="#_minimum_softwarehardware">Minimum software/hardware</a></li>
</ul>
</li>
<li><a href="#_scheme_overview">Scheme overview</a>
<ul class="sectlevel2">
<li><a href="#_assumptions_and_prerequisites">Assumptions and prerequisites</a></li>
<li><a href="#_tldr">TL;DR</a></li>
<li><a href="#_passwords_security_analysis">Passwords security analysis</a></li>
<li><a href="#_why_bitwarden">Why Bitwarden?</a></li>
<li><a href="#_legacy_and_bootstrapping">Legacy and bootstrapping</a></li>
<li><a href="#_pros">Pros</a></li>
<li><a href="#_cons">Cons</a></li>
</ul>
</li>
<li><a href="#_setup_guide">Setup guide</a>
<ul class="sectlevel2">
<li><a href="#_passwords_and_pins">Passwords and PINs</a></li>
<li><a href="#_iphone_setup">iPhone setup</a></li>
<li><a href="#_bitwarden_setup">Bitwarden setup</a></li>
<li><a href="#_macbook_setup">MacBook setup</a></li>
<li><a href="#_bootstrapping_setup">Bootstrapping setup</a></li>
<li><a href="#secure-info-storage">Really Secure Info storage</a></li>
<li><a href="#_crypto_wallets_and_seeds">Crypto wallets and seeds</a></li>
</ul>
</li>
<li><a href="#_threats">Threats</a>
<ul class="sectlevel2">
<li><a href="#_a_service_password_is_hacked">A service password is hacked</a></li>
<li><a href="#_laptop_is_stolen_the_password_is_not_known_to_an_attacker">Laptop is stolen, the password is not known to an attacker</a></li>
<li><a href="#_laptop_is_stolen_laptop_password_known_to_an_attacker">Laptop is stolen, laptop password known to an attacker</a></li>
<li><a href="#_iphone_is_stolen">iPhone is stolen</a></li>
<li><a href="#_iphone_is_stolen_with_pin">iPhone is stolen with PIN</a></li>
<li><a href="#_google_banned_you">Google banned you</a></li>
<li><a href="#_encrypted_data_is_lost">Encrypted data is lost</a></li>
<li><a href="#_sim_card_is_copied">SIM card is copied</a></li>
<li><a href="#_a_third_party_is_no_longer_trusted">A third party is no longer trusted</a></li>
<li><a href="#_death">Death</a></li>
<li><a href="#_the_laptop_is_rooted">The laptop is rooted</a></li>
<li><a href="#_targeted_cyber_attack_social_engineering">Targeted cyber attack, social engineering</a></li>
<li><a href="#_non_violent_intrusion">Non violent intrusion</a></li>
<li><a href="#_kidnapping_violence_thermorectal_cryptanalysis">Kidnapping, violence, thermorectal cryptanalysis</a></li>
<li><a href="#_spouse_malevolence">Spouse malevolence</a></li>
</ul>
</li>
<li><a href="#_scenarios">Scenarios</a>
<ul class="sectlevel2">
<li><a href="#_you_have_lost_everything">You have lost everything</a></li>
<li><a href="#_you_have_lost_everything_but_iphone">You have lost everything but iPhone</a></li>
<li><a href="#_lost_laptop_checklist">Lost laptop checklist</a></li>
<li><a href="#_lost_iphone_checklist">Lost iPhone checklist</a></li>
<li><a href="#_death_or_emergency">Death or emergency</a></li>
<li><a href="#_spouse_distrust">Spouse distrust</a></li>
<li><a href="#_3rd_party_distrust">3rd party distrust</a></li>
<li><a href="#_you_forgot_your_master_password_or_securepin">You forgot your Master Password or SecurePIN</a></li>
</ul>
</li>
<li><a href="#_glossary">Glossary</a></li>
<li><a href="#_bibliography_useful_links_and_resources">Bibliography, Useful Links, and Resources</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EX5W9GL9CM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EX5W9GL9CM');
</script>
</div>
</div>
<div class="sect1">
<h2 id="_abstract"><a class="link" href="#_abstract">Abstract</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Keeping your data safe is hard.
Keeping your data safe and easy to use among a multitude of devices and services is even harder.
Triple Sec is a KISS security setup scheme for your MacBook, iPhone,
and web services that is easy to use and relatively hard to break.</p>
</div>
<div class="paragraph">
<p>It&#8217;s based on the idea of using a combination of a random 3-4 word passphrase
and a 6-digit PIN, a password manager and TouchID/FaceID devices.</p>
</div>
<div class="paragraph">
<p>The scheme allows regaining access to all of your data
even in case of losing all of your devices, or in case of your death,
leaving your digital legacy to your loved ones.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_desired_properties"><a class="link" href="#_desired_properties">Desired properties</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_easy_to_use"><a class="link" href="#_easy_to_use">Easy to use</a></h3>
<div class="quoteblock">
<blockquote>
Security at the expense of usability comes at the expense of security
</blockquote>
<div class="attribution">
&#8212; AviD's Rule of Usability
</div>
</div>
<div class="paragraph">
<p>Nuff said.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lowest_amount_of_memorized_information"><a class="link" href="#_lowest_amount_of_memorized_information">Lowest amount of memorized information</a></h3>
<div class="paragraph">
<p>Humans are notoriously bad at memorizing long strings of random characters.
We are good at remembering short phrases and making up stories about them.</p>
</div>
<div class="paragraph">
<p>This classic XKCD is a good illustration of the problem</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://imgs.xkcd.com/comics/password_strength.png" alt="xkcd 936">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_no_single_point_of_failure"><a class="link" href="#_no_single_point_of_failure">No single point of failure</a></h3>
<div class="paragraph">
<p>Duh. Any device loss must not compromise your security or lead to sensitive data loss.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cross_platform"><a class="link" href="#_cross_platform">Cross-platform</a></h3>
<div class="paragraph">
<p>The scheme must work on any mobile, desktop, and web platform.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bootstrapping"><a class="link" href="#_bootstrapping">Bootstrapping</a></h3>
<div class="paragraph">
<p>Even if every hardware item you own is lost, you can still regain access to everything.
Imagine an act of God of your dislike. You&#8217;re fleeing from rashists in Ukraine or Siria.
There is a fire in your house. You get the point.</p>
</div>
</div>
<div class="sect2">
<h3 id="_legacy"><a class="link" href="#_legacy">Legacy</a></h3>
<div class="ulist">
<ul>
<li>
<p>Family and friends of your choice can access all your info in case of emergency or after your death</p>
</li>
<li>
<p>Any of them can be safely revoked from access to anything</p>
</li>
<li>
<p>If their devices are compromised, an attacker won&#8217;t be able to access your info</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_really_important_info_security"><a class="link" href="#_really_important_info_security">Really important info security</a></h3>
<div class="paragraph">
<p>You should be able to securely store some really important info that you want to keep extra safe.
For example, you have some important PGP keys, crypto wallets etc.
Or some passwords you don&#8217;t want to be in your Bitwarden, like your bank account or Google Account passwords.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Really important info can&#8217;t be accessed even when the laptop/phone is fully compromised</p>
</li>
<li>
<p>Really important info can&#8217;t be accessed even when your primary email/Bitwarden is compromised</p>
</li>
<li>
<p>Really important info can&#8217;t be accessed even when your 3rd parties are compromised</p>
</li>
<li>
<p>Plausible deniability. You can store really important info in a separate vault that is not accessible to your family and friends.
They can&#8217;t even know that you have such a vault.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_minimum_softwarehardware"><a class="link" href="#_minimum_softwarehardware">Minimum software/hardware</a></h3>
<div class="paragraph">
<p>We prefer well-known, well-tested, well-supported open-source software.
We prefer to use Apple hardware as they have a good reputation for security and privacy. But we don&#8217;t want to be locked in.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scheme_overview"><a class="link" href="#_scheme_overview">Scheme overview</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_assumptions_and_prerequisites"><a class="link" href="#_assumptions_and_prerequisites">Assumptions and prerequisites</a></h3>
<div class="ulist">
<ul>
<li>
<p>AES256, SHA256 are secure</p>
</li>
<li>
<p>FaceID and TouchID are secure</p>
</li>
<li>
<p>iPhones â‰¥ 7 are secure</p>
</li>
<li>
<p>MacBook FileVault2 is secure</p>
</li>
<li>
<p>Bitwarden is secure</p>
</li>
<li>
<p>VeraCrypt is secure</p>
</li>
<li>
<p>You have several 3-rd parties who can identify you and will cooperate</p>
</li>
<li>
<p>Your significant other is not an evil psychopath</p>
</li>
<li>
<p>You are not a subject of state-level attack</p>
</li>
<li>
<p>You use iPhone â‰¥ 7 with TouchID/FaceID</p>
</li>
<li>
<p>You use a MacBook with a T2 security chip</p>
</li>
<li>
<p>You have a Google account</p>
</li>
<li>
<p>Your MacBook and iPhone are not hacked at the time of setup</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tldr"><a class="link" href="#_tldr">TL;DR</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a random 6-digit PIN and memorize it. That&#8217;s your phone PIN and your SIM PIN.</p>
</li>
<li>
<p>Generate three random words using <a href="https://www.eff.org/dice">EFF Dice</a> or <a href="https://diceware.dmuth.org/">Diceware</a>.
Combine with the PIN and memorize the passphrase.
That&#8217;s your <a href="https://bitwarden.com/">Bitwarden</a> Master Password.</p>
</li>
<li>
<p>Take a word and combine it with the PIN. That&#8217;s your laptop password. You MAY store it in Bitwarden.</p>
</li>
<li>
<p>Use Bitwarden to generate strong passwords and TOTP 2FA codes for all your services.</p>
</li>
<li>
<p>Store your sensitive info in Bitwarden.</p>
</li>
<li>
<p>Store your really sensitive info in a Google Drive/iCloud synced VeraCrypt volume.</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="title">Example 1. Don&#8217;t use these values in real life</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>PIN 984073</p>
</li>
<li>
<p>Words: <code>cake</code> <code>roping</code> <code>vocation</code></p>
</li>
<li>
<p>Bitwarden Master password: <code>cake984073ropingvocation</code></p>
</li>
<li>
<p>Laptop password: <code>vocation984073</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>One good in-memory-only password protects all your other passwords, TOTP 2FA, Recovery codes, etc.</p>
</div>
<div class="paragraph">
<p>Use Bitwarden Password Generator to create strong, secure passwords or passphrases. Those are encrypted with a strong encryption algorithm and synced securely between your devices.</p>
</div>
<div class="paragraph">
<p>And you don&#8217;t need to enter your PIN, laptop password and Bitwarden password very often thanks to TouchID/FaceID.</p>
</div>
</div>
<div class="sect2">
<h3 id="_passwords_security_analysis"><a class="link" href="#_passwords_security_analysis">Passwords security analysis</a></h3>
<div class="paragraph">
<p>6-digit PIN is ~20 bits of entropy, 3 Diceware words give another ~39 bits of entropy, and a random PIN position provides another 2 bits of entropy.
Thus, the scheme gives roughly 60 bits of entropy for the Bitwarden Master Password.</p>
</div>
<div class="paragraph">
<p>Bitwarden <a href="https://bitwarden.com/help/what-encryption-is-used/#pbkdf2">uses 100,000</a> iterations of PBKDF2 with HMAC-SHA256
to derive the encryption key from the Master Password.
Assuming an attacker can compute PBKDF2-SHA256 with 1 GiOps/s (see <a href="#pbkdf2">[pbkdf2]</a>),
60 bits of entropy is enough to resist brute-force attacks for about 2 million years.</p>
</div>
<div class="listingblock">
<div class="title">JavaScript code to calculate the entropy and the number of years to brute-force the password</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const dicewareDictionary = 7776; // 6^5
const dicewareWords = 3;
const dicewareBits = Math.log2(dicewareDictionary ** dicewareWords);
const pinLength = 6;
const pinBits = Math.log2(10 ** pinLength);
// [1] word1 [2] word2 [3] word3 [4] â€“ 4 places to put the PIN
const permutationBits = Math.log2(4);
const entropyBits = Math.floor(dicewareBits + pinBits + permutationBits);
const pbkdf2Sha256PerSecond = 1e9; // 1 GH/s
// Bitwarden uses 100,000 iterations of PBKDF2 with HMAC-SHA256
const iterations = 100000;
const pwdPerSecond = pbkdf2Sha256PerSecond / iterations;
// on average an attacker needs to try half of the passwords
const numTries = 2 ** (entropyBits - 1);
const seconds = numTries / pwdPerSecond;
const secondsInYear = 365 * 24 * 60 * 60;
const years = seconds / secondsInYear;
console.log('Password Entropy: ' + entropyBits + ' bits ')
console.log('Estimated time to brute-force: ' + years + ' years')
// outputs:
// Password Entropy: 60 bits
// Estimated time to brute-force: 1827945.0542346002 years</code></pre>
</div>
</div>
<div class="paragraph">
<p>iPhones and MacBooks with T2 chips mitigate password brute-force attacks by requiring a longer delay between password attempts on the hardware level.
iPhone can be configured to wipe all the data after 10 unsuccessful attempts.</p>
</div>
<div class="paragraph">
<p>Even with the <a href="https://appleinsider.com/articles/22/02/17/password-cracking-tool-can-slowly-brute-force-t2-mac-passwords">recently discovered flaw</a>, MacBooks' passwords can be tried at 15 passwords per second.
With 2<sup>32</sup> passwords to try, on average, it would take about 9 years to brute-force, making it impractical.</p>
</div>
</div>
<div class="sect2">
<h3 id="_why_bitwarden"><a class="link" href="#_why_bitwarden">Why Bitwarden?</a></h3>
<div class="paragraph">
<p>Bitwarden is open-source, cross-platform, cross-browser, free, and has a good reputation. The code is audited, and the company is trustworthy.</p>
</div>
<div class="paragraph">
<p>It supports storing TOTP 2FA, TouchID/FaceID unlocking, allows Emergency Access, and it&#8217;s easy to use. It is well-integrated with iOS and macOS.</p>
</div>
<div class="paragraph">
<p>Apple Keychain is not open-source, and it&#8217;s not cross-platform. It&#8217;s not integrated with Chrome or Firefox browsers and doesn&#8217;t support TOTP 2FA.</p>
</div>
<div class="paragraph">
<p><a href="https://1password.com/">1Password</a> is a good alternative, but it&#8217;s not open-source, and it&#8217;s not free.
Anyhow, this scheme can be easily used with 1Password as well. You don&#8217;t need to switch to Bitwarden if you already use 1Password. The same rules apply.</p>
</div>
<div class="paragraph">
<p><a href="https://keepassxc.org/">KeyPassXC</a> doesn&#8217;t work on iPhones.</p>
</div>
<div class="paragraph">
<p><a href="https://blog.lastpass.com/2022/12/notice-of-recent-security-incident/">Avoid LastPass</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_legacy_and_bootstrapping"><a class="link" href="#_legacy_and_bootstrapping">Legacy and bootstrapping</a></h3>
<div class="paragraph">
<p>If you want to leave your digital legacy to your loved ones,
you can do it with Bitwarden <a href="https://bitwarden.com/help/emergency-access/">Emergency Access</a>.</p>
</div>
<div class="paragraph">
<p>If you have some Really Secure Info and you store it in a separate vault,
you can leave the vault password to your loved ones.</p>
</div>
<div class="paragraph">
<p>You store your Secure Vault password in an encrypted file
that you share with your loved ones.</p>
</div>
<div class="paragraph">
<p>The encryption password is derived from your Master Password.
You store it in your Google Digital Legacy Plan along with instructions on accessing your Secure Vault.</p>
</div>
<div class="paragraph">
<p>In case of your death, your loved ones will receive a notification from Google
and can access your encrypted file with your Secure Vault password.</p>
</div>
<div class="paragraph">
<p>If you lose all your devices, you can ask your loved ones
to give you the encrypted file with your Secure Vault password,
derive the password from your Master Password, and access your Secure Vault.</p>
</div>
<div class="paragraph">
<p>If you stop trusting one of your loved ones
you can revoke their access to your encrypted file by changing a version of the derived password,
re-encrypting the file and sharing it with your loved ones again.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to update your Google Digital Legacy Plan accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pros"><a class="link" href="#_pros">Pros</a></h3>
<div class="ulist">
<ul>
<li>
<p>remember only 3 words and 6 digits, easy</p>
</li>
<li>
<p>super easy to use, rarely need to enter your PIN, laptop password or Bitwarden password</p>
</li>
<li>
<p>loss of any device is neither a security nor data loss concern</p>
</li>
<li>
<p>can bootstrap from nothing just knowing your Master password</p>
</li>
<li>
<p>Bitwarden password is good enough for brute-force attacks in case the vault is breached (like in LastPass situation)</p>
</li>
<li>
<p>laptop password is good enough to resist brute-force attacks in case the laptop is stolen</p>
</li>
<li>
<p>you can share your PIN and even your laptop password with your significant other, and they still can&#8217;t easily access Master Password-protected items in Bitwarden. They can if they know what they are doing, though.</p>
</li>
<li>
<p>in case you distrust your significant other â€“ change your PIN on your phone, laptop, and Bitwarden.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_cons"><a class="link" href="#_cons">Cons</a></h3>
<div class="ulist">
<ul>
<li>
<p>you are screwed if someone shoulder-hunts or records your Bitwarden password,
unless you set up 2FA in Bitwarden.
Watch your back when you need to enter the password.</p>
</li>
<li>
<p>you are screwed if an attacker has access to your phone or laptop and knows their passwords</p>
</li>
<li>
<p>you are screwed in case of your spouse is malevolent and knows the scheme</p>
</li>
<li>
<p>you are screwed if the laptop is rooted or even keylogged</p>
</li>
<li>
<p>you don&#8217;t want to store crypto wallet seeds in Bitwarden with this setup,
unless you are accepting the risk of losing your crypto</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_guide"><a class="link" href="#_setup_guide">Setup guide</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_passwords_and_pins"><a class="link" href="#_passwords_and_pins">Passwords and PINs</a></h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><input type="checkbox" data-item-complete="0"> Generate a random 6-digit PIN and memorize it. That&#8217;s your phone passcode.</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Generate 3 random words using <a href="https://bitwarden.com/password-generator/">Bitwarden Password Generator</a>, <a href="https://www.eff.org/dice">EFF Dice</a>, <a href="https://diceware.dmuth.org/">Diceware</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Or use the random words generator below. It uses <a href="https://www.w3.org/TR/WebCryptoAPI/">Web Crypto API</a> of your browser to generate random numbers.</p>
</div>
<div id="generator" class="exampleblock">
<div class="title">Example 2. Passwords Generator</div>
<div class="content">
<p>Random PIN: <code id="pin"></code><p>
<p>Random words: <code id="words"></code><p>
<p>Master Password: <code id="MasterPassword"></code><p>
<p>Laptop Password: <code id="LaptopPassword"></code><p>
<p><button id="GenerateButton">Generate</button><p>
<script src="wordlist.js">
</script>
<script>
let pinStr = '';
let MasterPassword = '';
function generate() {
  const array = new Uint32Array(5);
  self.crypto.getRandomValues(array);
  const pin = array[0] % 1000000;
  pinStr = pin.toString().padStart(6, "0");
  document.getElementById("pin").innerText = pinStr;
  const words = [
    wordlist[array[1] % (6**5)],
    wordlist[array[2] % (6**5)],
    wordlist[array[3] % (6**5)]
  ];
  const permutation = array[4] % 4;
  const parts = [];
  for (let i = 0; i < 3; i++) {
    if (permutation === i) parts.push(pinStr);
    parts.push(words[i]);
  }
  if (permutation === 3) parts.push(pinStr);
  MasterPassword = parts.join("");
  let LaptopPassword = words[0] + pinStr;
  document.getElementById("words").innerText = words.join(" ");
  document.getElementById("MasterPassword").innerText = MasterPassword;
  document.getElementById("LaptopPassword").innerText = LaptopPassword;
}
document.getElementById("GenerateButton").onclick = generate;
generate();
</script>
</div>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Combine with the PIN and memorize the passphrase.
That&#8217;s your Bitwarden Master Password.</p>
</li>
<li>
<p>&#10063; Take a word and combine it with PIN. That&#8217;s your laptop password. You MAY store it in Bitwarden.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_iphone_setup"><a class="link" href="#_iphone_setup">iPhone setup</a></h3>
<div class="ulist">
<ul>
<li>
<p>Setup iPhone passcode to be PIN: <em>Settings &#8594; Face ID &amp; Passcode</em></p>
</li>
<li>
<p>Delete all existing TouchID fingerprints or FaceID data and set up new ones: <em>Settings &#8594; Face ID &amp; Passcode &#8594; Reset Face ID</em></p>
</li>
<li>
<p>Enable SIM PIN, set it to the first 4 digits of your iPhone PIN: <em>Settings &#8594; Mobile Data &#8594; Carrier &#8594; SIM PIN</em></p>
<div class="paragraph">
<p>This way, we protect your phone from SIM hijacking and SIM swap attacks.
An attacker can&#8217;t use your phone for 2FA via SMS if they don&#8217;t have your PIN.</p>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Optionally:</div>
<ul>
<li>
<p>Enable wiping your data after 10 wrong attempts if you want to be extra secure:
<em>Settings &#8594; Face ID &amp; Passcode &#8594; Erase Data</em>.</p>
</li>
<li>
<p>Set up a security question/password with your mobile service provider to avoid SIM hijacking. Store it in Bitwarden.</p>
</li>
<li>
<p>Disable all notifications on the locked screen.
<em>Settings &#8594; Notifications &#8594; Show Previews &#8594; When Unlocked</em></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_bitwarden_setup"><a class="link" href="#_bitwarden_setup">Bitwarden setup</a></h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><input type="checkbox" data-item-complete="0"> Install Bitwarden app on all your devices and Bitwarden extensions for your web browsers. Enable TouchID/FaceID integration.</p>
<div class="paragraph">
<p>You MAY enable 2FA for your Bitwarden account. It&#8217;s not necessary, but it&#8217;s good practice. Don&#8217;t use TOTP. Use email, YubiKey, FIDO2, and Recovery Code instead.</p>
</div>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Setup Bitwarden <a href="https://bitwarden.com/help/getting-started-browserext/#unlock-with-pin-or-biometrics">Unlock with Biometrics</a> option.</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Optionally, setup 2FA for your Bitwarden account. It&#8217;s not necessary, but it&#8217;s good practice. Don&#8217;t use TOTP. Use email, YubiKey, FIDO2, and Recovery Code.</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Setup <a href="https://bitwarden.com/help/log-in-with-device/">Log in with Device</a> for your iPhone.</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Import all your passwords from other password managers to Bitwarden. <a href="https://bitwarden.com/help/import-data/">Import Data</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Store all passwords, TOTPs, Recovery codes etc., in Bitwarden.</p>
</div>
<div class="paragraph">
<p>Use Bitwarden Password Generator to generate secure passwords or passphrases.</p>
</div>
<div class="paragraph">
<p>Enable TOTP 2FA everywhere where there is such an option: Google, Facebook, Twitter, Instagram, banking, crypto exchanges, mobile providers etc.</p>
</div>
<div class="paragraph">
<p>If you use Google Authenticator, Duo, Authy or another, you may want to migrate to TOTP 2FA in Bitwarden to simplify things. It&#8217;s OK.</p>
</div>
</div>
<div class="sect2">
<h3 id="_macbook_setup"><a class="link" href="#_macbook_setup">MacBook setup</a></h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Enable FileVault2 encryption: <em>System Settings &#8594; Privacy &amp; Security &#8594; FileVault</em>.</p>
</li>
<li>
<p>&#10063; Store the hard drive Recovery code in Bitwarden.</p>
</li>
<li>
<p>&#10063; Enable TouchID</p>
</li>
<li>
<p>&#10063; Enable Firewall</p>
</li>
<li>
<p>&#10063; Set up <a href="https://apple.stackexchange.com/a/306324">PAM with TouchID</a> to avoid entering the laptop password on the <code>sudo</code> commands.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You&#8217;ll have to enter your laptop password only after a reboot. Avoid doing it with someone watching or near a camera.</p>
</div>
<div class="paragraph">
<p>Unlock Bitwarden with TouchID, and avoid typing your Master password. Login to Bitwarden Web Vault using your iPhone when needed.</p>
</div>
<div class="paragraph">
<p>Use TouchID for sudo, ssh, payments, FIDO2, etc.</p>
</div>
<div class="paragraph">
<p>A helpful tool is <a href="https://github.com/maxgoedjen/secretive">Secretive</a> â€“ an app for storing and managing SSH keys in the Mac T2 Secure Enclave.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bootstrapping_setup"><a class="link" href="#_bootstrapping_setup">Bootstrapping setup</a></h3>
<div id="linux_usb_boot" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ideally, this should be done on a USB-booted Linux, like <a href="https://www.kali.org/">Kali Linux</a> or <a href="https://tails.boum.org/">Tails Linux</a>.
But, at the time of writing, all of them have issues with MacBooks with T2 chips: the keyboard and trackpad don&#8217;t work.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a <code>Readme-$version.txt</code> file that contains the following information:</p>
<div class="ulist">
<ul>
<li>
<p>Master Password</p>
</li>
<li>
<p>PIN</p>
</li>
<li>
<p>Google Account Backup Codes</p>
</li>
<li>
<p>Bitwarden Backup Code</p>
</li>
<li>
<p>iCloud Backup Code</p>
</li>
<li>
<p>VeraCrypt Passwords</p>
</li>
<li>
<p>Other passwords not stored in Bitwarden</p>
</li>
</ul>
</div>
</li>
<li>
<p>Derive a password for the <code>Readme.txt</code> file from the Master Password.</p>
<details>
<summary class="title">JavaScript code to compute the <code>DerivedMasterPwd</code></summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const version = 0
const pwd = 'cake984073ropingvocation'
const salt = '984073'
const iterations = 100000 + version

const textEncoder = new TextEncoder("utf-8");
const passwordBuffer = textEncoder.encode(pwd);
const importedKey = await crypto.subtle.importKey("raw", passwordBuffer, "PBKDF2", false, ["deriveBits"]);

const saltBuffer = textEncoder.encode(salt);
const params = {name: "PBKDF2", hash: 'SHA-256', salt: saltBuffer, iterations: iterations};
const derivation = await crypto.subtle.deriveBits(params, importedKey, 32*8);
function buf2hex(buffer) { // buffer is an ArrayBuffer
  return [...new Uint8Array(buffer)].map(x =&gt; x.toString(16).padStart(2, '0')).join('');
}
console.log(buf2hex(derivation));</code></pre>
</div>
</div>
</div>
</details>
<p>Master Password: <input id="MasterPwdInput"/></p>
<p>PIN: <input id="Pin"/></p>
<p>Version: <input id="Version" value='0'/></p>
<button id="Compute">Compute</button>
<p>Derived Master Password: <code id="DerivedMasterPwd"></code></p>
<script>
function buf2hex(buffer) { // buffer is an ArrayBuffer
  return [...new Uint8Array(buffer)] .map(x => x.toString(16).padStart(2, '0')).join('');
}
async function compute() {
  const version = document.getElementById('Version').value || 0
  const pwd = document.getElementById('MasterPwdInput').value
  const salt = document.getElementById('Pin').value
  const iterations = 100000 + version
  const textEncoder = new TextEncoder("utf-8");
  const passwordBuffer = textEncoder.encode(pwd);
  const importedKey = await crypto.subtle.importKey("raw", passwordBuffer, "PBKDF2", false, ["deriveBits"]);

  const saltBuffer = textEncoder.encode(salt);
  const params = {name: "PBKDF2", hash: 'SHA-256', salt: saltBuffer, iterations: iterations};
  const derivation = await crypto.subtle.deriveBits(params, importedKey, 32*8);

  document.getElementById('DerivedMasterPwd').innerText = buf2hex(derivation);
}
document.getElementById('MasterPwdInput').value = MasterPassword;
document.getElementById('Pin').value = pinStr;
document.getElementById('Compute').onclick = compute;
compute();
</script>
</li>
<li>
<p>Encrypt Readme-$version.txt with <code>DerivedMasterPwd</code> using AES256</p>
<div class="literalblock">
<div class="content">
<pre>gpg -c --cipher-algo AES256 Readme-0.txt</pre>
</div>
</div>
</li>
<li>
<p>Transfer <code>Readme-0.txt.gpg</code> via Signal with auto-delete to trusted 3-rd parties. Ask to verify your identity upon requesting the file.</p>
</li>
<li>
<p>Remove <code>Readme.txt</code> and <code>Readme-0.txt.gpg</code> from the laptop!</p>
</li>
<li>
<p>Go to <a href="https://myaccount.google.com/data-and-privacy">Google Account &#8594; Data &amp; Privacy</a></p>
</li>
<li>
<p>Make a Plan for your Digital Legacy</p>
<div class="paragraph">
<p>Choose who to notify &amp; what to share.</p>
</div>
</li>
<li>
<p>Store the <code>DerivedMasterPwd</code> in your Google Digital Legacy Plan.</p>
<div class="quoteblock">
<div class="title">Example note</div>
<blockquote>
I guess I&#8217;m dead. Decrypt Readme-0.txt.gpg with <code>DerivedMasterPwd</code> to get my passwords. See-ya!
gpg -d --cipher-algo AES256 Readme-0.txt.gpg
</blockquote>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="secure-info-storage"><a class="link" href="#secure-info-storage">Really Secure Info storage</a></h3>
<div class="paragraph">
<p>You may want to store some really important info in a really secure way. For example, your crypto wallet seeds, PGP keys, Bitwarden Recovery Code etc.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll need <a href="https://veracrypt.fr/">VeraCrypt</a>. It&#8217;s a free open source disk encryption software for Windows, Mac OSX and Linux.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a <code>SecurePIN</code> (6 digits), <code>VeraCryptNormalPassword</code> and <code>VeraCryptHiddenPassword</code>.</p>
<div class="paragraph">
<p>Use <a href="#generator">the random generator</a>.</p>
</div>
<div class="paragraph">
<p>Use a permutation of your <code>Master Password</code>, <code>PIN</code>, and <code>SecurePIN</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Don&#8217;t use these in real life</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>SecurePin: <code>850817</code></p>
</li>
<li>
<p>VeraCrypt Normal Password: <code>vocation984073</code></p>
</li>
<li>
<p>VeraCrypt Hidden Password: <code>trimmer850817erasedeligible</code></p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Create a VeraCrypt volume with a hidden volume synced to Google Drive or iCloud Drive.</p>
</li>
<li>
<p>Store seeds, PGP keys, Readme.txt etc., on your hidden volume</p>
</li>
<li>
<p>Store something plausible on a normal volume</p>
</li>
<li>
<p>In case you are forced to reveal the password to your VeraCrypt volume â€“ you reveal your <code>VeraCryptNormalPassword</code> and deny the existence of the hidden volume. See <a href="https://veracrypt.fr/en/Hidden%20Volume.html">Hidden Volume</a> and <a href="https://veracrypt.fr/en/Plausible%20Deniability.html">Plausible Deniability</a>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ideally, you do this on a USB-booted Linux, but see <a href="#linux_usb_boot">a note about that</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_crypto_wallets_and_seeds"><a class="link" href="#_crypto_wallets_and_seeds">Crypto wallets and seeds</a></h3>
<div class="paragraph">
<p>Use a hardware wallet for storing crypto assets you don&#8217;t want to lose.
<a href="https://shop.ledger.com/pages/hardware-wallets-comparison">Ledgers</a> is a good choice. Others are <a href="https://trezor.io/">Trezor</a> and <a href="https://blockstream.com/jade/">Jade</a>.</p>
</div>
<div class="paragraph">
<p>For a hardware wallet, either use your phone <code>PIN</code> or generate another 6-digit random <code>SecurePIN</code>, depending on your paranoia.</p>
</div>
<div class="paragraph">
<p>Store your seed and <code>SecurePIN</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in <code>Readme.txt</code> from the <a href="#Bootstrapping Setup">[Bootstrapping Setup]</a></p>
</li>
<li>
<p>or store the seed in the hidden volume of your <a href="#secure-info-storage">Really Secure Info Storage</a>.</p>
</li>
<li>
<p>or even better, store the seed on a separate <a href="https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872">old offline iPhone </a> with the <code>SecurePIN</code> as a passcode.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_threats"><a class="link" href="#_threats">Threats</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_a_service_password_is_hacked"><a class="link" href="#_a_service_password_is_hacked">A service password is hacked</a></h3>
<div class="paragraph">
<p>Just change your password for that service.
You are using 2FA, right?</p>
</div>
</div>
<div class="sect2">
<h3 id="_laptop_is_stolen_the_password_is_not_known_to_an_attacker"><a class="link" href="#_laptop_is_stolen_the_password_is_not_known_to_an_attacker">Laptop is stolen, the password is not known to an attacker</a></h3>
<div class="paragraph">
<p>An average thief can&#8217;t access anything to get to your data.</p>
</div>
<div class="paragraph">
<p>An advanced attacker can tamper the TouchID,
 do <code>sudo su -</code> with TouchID and gain admin privileges.
Then you are mostly screwed. Your <a href="#secure-info-storage">Really Secure Info Storage</a> is safe, though.</p>
</div>
</div>
<div class="sect2">
<h3 id="_laptop_is_stolen_laptop_password_known_to_an_attacker"><a class="link" href="#_laptop_is_stolen_laptop_password_known_to_an_attacker">Laptop is stolen, laptop password known to an attacker</a></h3>
<div class="ulist">
<ul>
<li>
<p>Attacker CAN access your Bitwarden, Gmail, TouchID/FIDO2, Github, Social Media, Messengers, iCloud, Google Account, etc.</p>
</li>
<li>
<p>Attacker CAN access and unlink the laptop in iCloud by using TouchID and Safari browser to log in to iCloud. I don&#8217;t know how to prevent this.</p>
</li>
<li>
<p>Attacker MAY steal your Google account if you use iCloud email as a backup email and TouchID as 2FA. I don&#8217;t know how to prevent this.</p>
</li>
<li>
<p>Attacker CAN NOT access <code>SecureStorage</code> as he doesn&#8217;t know the password</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_iphone_is_stolen"><a class="link" href="#_iphone_is_stolen">iPhone is stolen</a></h3>
<div class="paragraph">
<p>Assuming your PIN/password is unknown to the attacker, you are safe.
Your SIM card is safe, too.</p>
</div>
</div>
<div class="sect2">
<h3 id="_iphone_is_stolen_with_pin"><a class="link" href="#_iphone_is_stolen_with_pin">iPhone is stolen with PIN</a></h3>
<div class="ulist">
<ul>
<li>
<p>Attacker CAN access your Bitwarden, Gmail, TouchID/FIDO2, Github, Social Media, Messengers, iCloud, Google Account, etc.</p>
</li>
<li>
<p>Attacker CAN access and unlink the laptop in iCloud by using TouchID and Safari browser to log in to iCloud. I don&#8217;t know how to prevent this.</p>
</li>
<li>
<p>Attacker MAY steal your Google account if you use iCloud email as a backup email and TouchID as 2FA. I don&#8217;t know how to prevent this.</p>
</li>
<li>
<p>Attacker CAN NOT access <a href="#secure-info-storage">Really Secure Info Storage</a> as he doesn&#8217;t know the password</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_google_banned_you"><a class="link" href="#_google_banned_you">Google banned you</a></h3>
<div class="paragraph">
<p>Access a local copy of your <a href="#secure-info-storage">Really Secure Info Storage</a> data on one of your devices. You are fine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_encrypted_data_is_lost"><a class="link" href="#_encrypted_data_is_lost">Encrypted data is lost</a></h3>
<div class="paragraph">
<p>Restore from backup or get it from Google Drive/iCloud on another device.
You are fine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sim_card_is_copied"><a class="link" href="#_sim_card_is_copied">SIM card is copied</a></h3>
<div class="paragraph">
<p>You avoid SMS 2FA as much as possible, don&#8217;t you? You are fine then.
Just restore your SIM card at your carrier office.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_third_party_is_no_longer_trusted"><a class="link" href="#_a_third_party_is_no_longer_trusted">A third party is no longer trusted</a></h3>
<div class="ulist">
<ul>
<li>
<p>Increment the version of your Readme-$version.txt</p>
</li>
<li>
<p>Derive a new <code>DerivedMasterPwd</code> with <code>MasterPassword</code>, <code>PIN</code> and a new version using the algorithm from <a href="#Bootstrapping Setup">[Bootstrapping Setup]</a></p>
</li>
<li>
<p>Re-encrypt your <code>Readme-$version.txt</code> with it.</p>
</li>
<li>
<p>Share it with your trusted 3rd parties.</p>
</li>
<li>
<p>Update your <code>DerivedMasterPwd</code> in your Google Digital Legacy Plan.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now the distrusted 3rd party can&#8217;t access your secrets after your death.</p>
</div>
</div>
<div class="sect2">
<h3 id="_death"><a class="link" href="#_death">Death</a></h3>
<div class="paragraph">
<p>You have your Legacy plan in place.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_laptop_is_rooted"><a class="link" href="#_the_laptop_is_rooted">The laptop is rooted</a></h3>
<div class="paragraph">
<p>You are mostly screwed.
Your Really Secret Info is safe if you only access it on a USB-booted Linux or a specific air-gapped device.
Also, don&#8217;t store Readme.txt.gpg on your laptop or in the cloud.</p>
</div>
</div>
<div class="sect2">
<h3 id="_targeted_cyber_attack_social_engineering"><a class="link" href="#_targeted_cyber_attack_social_engineering">Targeted cyber attack, social engineering</a></h3>
<div class="paragraph">
<p>That depends. You can be screwed if you are targeted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_non_violent_intrusion"><a class="link" href="#_non_violent_intrusion">Non violent intrusion</a></h3>
<div class="paragraph">
<p>If you are forced to reveal your secrets by law, your Real Secret Info is OK.
See <a href="#plausible-deniability">plausible deniability</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_kidnapping_violence_thermorectal_cryptanalysis"><a class="link" href="#_kidnapping_violence_thermorectal_cryptanalysis">Kidnapping, violence, thermorectal cryptanalysis</a></h3>
<div class="paragraph">
<p>You are screwed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://imgs.xkcd.com/comics/security.png" alt="xkcd 538">
</div>
</div>
<div class="paragraph">
<p>Use other means for storing your crypto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_spouse_malevolence"><a class="link" href="#_spouse_malevolence">Spouse malevolence</a></h3>
<div class="paragraph">
<p>Assume that your spouse knows your PIN/laptop password.</p>
</div>
<div class="paragraph">
<p>They can access your Bitwarden, Gmail, TouchID/FIDO2, Github, Social Media, Messengers, iCloud, Google Account, etc., by adding their TouchID/FaceID to your devices.</p>
</div>
<div class="paragraph">
<p>They can find your <code>DerivedMasterPwd</code>, <code>Readme.txt.gpg</code>, and access your <code>SecureStorage</code>. You are screwed.</p>
</div>
<div class="paragraph">
<p>If you suspect your spouse to become malevolent, you can change your iPhone PIN and your laptop password and reset all TouchID/FaceIDs. That should suffice.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scenarios"><a class="link" href="#_scenarios">Scenarios</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_you_have_lost_everything"><a class="link" href="#_you_have_lost_everything">You have lost everything</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ask a 3rd party for SecurityInfoFile</p>
</li>
<li>
<p>Compute <code>DerivedMasterPwd</code></p>
</li>
<li>
<p>Login to Bitwarden with Bitwarden Backup Code</p>
</li>
<li>
<p>Login to iCloud using iCloud Backup Code</p>
</li>
<li>
<p>Login to GMail using Google Account Backup Codes</p>
</li>
<li>
<p>Restore crypto wallets from seeds, PGP keys etc., from your VeraCrypt volume on Google Drive</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_you_have_lost_everything_but_iphone"><a class="link" href="#_you_have_lost_everything_but_iphone">You have lost everything but iPhone</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Do the checklist of a stolen laptop</p>
</li>
<li>
<p>Restore wallets from seeds, transfer crypto</p>
</li>
<li>
<p>Erase all stolen devices</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_lost_laptop_checklist"><a class="link" href="#_lost_laptop_checklist">Lost laptop checklist</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to Bitwarden Web Vault</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><input type="checkbox" data-item-complete="0"> Go to Account Settings</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Deauthorize your laptop session</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Change Bitwarden password</p>
</li>
</ul>
</div>
</li>
<li>
<p>Login to iCloud</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><input type="checkbox" data-item-complete="0"> Settings &#8594; Sing Out of All Browsers</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> Find Devices &#8594; Laptop &#8594; Erase Mac</p>
</li>
</ul>
</div>
</li>
<li>
<p>Login to Google</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><input type="checkbox" data-item-complete="0"> Manage Account &#8594; Your devices &#8594; Sing out</p>
</li>
<li>
<p><input type="checkbox" data-item-complete="0"> 2FA &#8594; Remove TouchID key</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_lost_iphone_checklist"><a class="link" href="#_lost_iphone_checklist">Lost iPhone checklist</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login to Bitwarden web vault</p>
</li>
<li>
<p>Go to Account Settings</p>
</li>
<li>
<p>Deauthorize session</p>
</li>
<li>
<p>Change Bitwarden password</p>
</li>
<li>
<p>Login to iCloud</p>
</li>
<li>
<p>Settings &#8594; Sing Out of All Browsers</p>
</li>
<li>
<p>Find Devices &#8594; iPhone &#8594; Erase iPhone</p>
</li>
<li>
<p>Login to Google</p>
</li>
<li>
<p>Manage Account &#8594; Your devices &#8594; Sing out</p>
</li>
<li>
<p>Banks as well</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_death_or_emergency"><a class="link" href="#_death_or_emergency">Death or emergency</a></h3>
<div class="paragraph">
<p>Spouses can access a laptop/phone, access Bitwarden/Gmail.
Leave an Emergency Note and tell them to look it up in an emergency.
Google Account Inactivity set up for three months with EmergencyInfo
EmergencyInfo = DerivedMasterPwd, Ledger/OldPhone SecurePIN</p>
</div>
</div>
<div class="sect2">
<h3 id="_spouse_distrust"><a class="link" href="#_spouse_distrust">Spouse distrust</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change iPhone PIN</p>
</li>
<li>
<p>Remove all iPhone FaceIDs and set up a new one</p>
</li>
<li>
<p>Change the laptop password PIN to the new iPhonePIN</p>
</li>
<li>
<p>Revoke Bitwarden Inactivity Access</p>
</li>
<li>
<p>Revoke Google Inactivity Access</p>
</li>
<li>
<p>Revoke iCloud Recovery Account</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_3rd_party_distrust"><a class="link" href="#_3rd_party_distrust">3rd party distrust</a></h3>
<div class="ulist">
<ul>
<li>
<p>Increment the version of your <code>Readme-$version.txt</code> (e.g. <code>Readme-1.txt</code>)</p>
</li>
<li>
<p>Derive a new <code>DerivedMasterPwd</code> with <code>MasterPassword</code>, <code>PIN</code> and a new version using the algorithm from <a href="#_bootstrapping_setup">Bootstrapping setup</a></p>
</li>
<li>
<p>Re-encrypt your <code>Readme-$version.txt</code> with the new <code>DerivedMasterPwd</code></p>
</li>
<li>
<p>Share it with your trusted 3-rd parties</p>
</li>
<li>
<p>Update your <code>DerivedMasterPwd</code> in your Google Digital Legacy Plan</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The distrusted 3-rd party can&#8217;t access your secrets after your death or inactivity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_you_forgot_your_master_password_or_securepin"><a class="link" href="#_you_forgot_your_master_password_or_securepin">You forgot your Master Password or SecurePIN</a></h3>
<div class="ulist">
<ul>
<li>
<p>Go to your Google Digital Legacy Plan and get your <code>DerivedMasterPwd</code> from there.</p>
</li>
<li>
<p>Ask your trusted 3-rd parties to give you the <code>Readme-$version.txt.gpg</code> file.</p>
</li>
<li>
<p>Decrypt it with <code>DerivedMasterPwd</code> and get your <code>MasterPassword</code> and <code>PIN</code>.</p>
<div class="literalblock">
<div class="content">
<pre>gpg -d --cipher-algo AES256 Readme-0.txt.gpg</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary"><a class="link" href="#_glossary">Glossary</a></h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">KISS</dt>
<dd>
<p>Keep It Simple Stupid</p>
</dd>
<dt class="hdlist1">TOTP</dt>
<dd>
<p>Time-based One-time Password</p>
</dd>
<dt class="hdlist1">2FA</dt>
<dd>
<p>Two-factor Authentication</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bibliography_useful_links_and_resources"><a class="link" href="#_bibliography_useful_links_and_resources">Bibliography, Useful Links, and Resources</a></h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="crypto"></a>[crypto]
<a href="https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872" class="bare">https://medium.com/@vincentbounce/cryptos-storage-transmission-the-safest-method-314560032872</a></p>
</li>
<li>
<p><a id="pbkdf2"></a>[pbkdf2] <a href="https://www.usenix.org/system/files/conference/woot16/woot16-paper-ruddick.pdf">Acceleration Attacks on PBKDF2</a></p>
</li>
<li>
<p><a id="T2"></a>[T2] <a href="https://www.youtube.com/watch?v=0uh4vQa81AI">Physical Decrypted Images from Macs with the T2 Chip</a></p>
</li>
<li>
<p><a id="EFF"></a>[EFF] <a href="https://ssd.eff.org/module-categories/basics">EFF Basics</a></p>
</li>
<li>
<p><a id="Pwd"></a>[Pwd] <a href="https://ssd.eff.org/module/creating-strong-passwords">Creating Strong Passwords</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-01-11 16:18:10 +0100
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>